<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Save And Get Test</title>
    <script src="/packages/libs/ofa/ofa.js" type="module"></script>
  </head>
  <body>
    <script src="/sw/register.js" type="module"></script>
    <script type="module">
      setTimeout(async () => {
        console.log("c1");
        const c = await caches.open("test-dir103");
        console.log("c2: ", c);

        // BUG: 在safari隐私模式中，只要刷新一次，保存 cache storage的内容就会被清空
        // 向c中添加一个测试数据
        const data = {
          name: "test",
          age: 18,
        };
        await c.put("/ttt", new Response(JSON.stringify(data)));

        // 从c中获取数据
        let res = await c.match("/ttt");
        res = await res.clone();
        console.log("res: ", res);
        const resData = await res.json();
        console.log("resData: ", resData);

        // // 打印c中的所有key
        // const keys = await c.keys();
        // console.log("keys: ", keys);
        // // 打印c中所有的value
        // const values = await c.getAll();
        // console.log("values: ", values);

        // const m = await c.match("/test-dir10");
        // console.log("m: ", m);
      }, 100);
    </script>
    <script type="module" src="./save-and-get.js"></script>
  </body>
</html>
