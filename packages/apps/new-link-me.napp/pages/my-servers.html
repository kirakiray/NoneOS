<template page>
  <l-m src="/packages/pui/list/list.html"></l-m>
  <l-m src="../comps/server-item.html"></l-m>
  <style>
    :host {
      display: block;
    }
    h4 {
      display: flex;
      margin: 0;
      padding: 0;
    }
  </style>
  <p-list-item button="suffix" collapse-childs="open">
    <h4>
      <localized-content>
        <span lang="en">My Servers</span>
        <span lang="cn">我的服务器</span>
        <span lang="jp">マイサーバー</span>
      </localized-content>
      ({{ list.length }})
    </h4>

    <i toggle-collapse triangle slot="suffix"></i>
    <p-list slot="childs">
      <o-fill :value="list">
        <p-list-item>
          <n-server-item :url="$data.url"></n-server-item>
        </p-list-item>
      </o-fill>
    </p-list>
  </p-list-item>
  <script>
    export default async ({ load }) => {
      const { createUser } = await load("/packages/new-user/main.js");
      const user = await createUser();

      const serverManager = await user.serverManager();

      return {
        data: {
          list: [],
        },
        proto: {},
        async attached() {
          this.list = serverManager.data;
        },
        detached() {},
      };
    };
  </script>
</template>
