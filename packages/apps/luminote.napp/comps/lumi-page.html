<template component>
  <l-m src="./lumi-block.html"></l-m>
  <style>
    :host {
      display: block;
      margin: 0 auto;
    }
  </style>
  <div class="container">
    <div style="height: 100px"></div>
    <o-fill id="lumi-fill-el" :value="contents">
      <lumi-block
        :type="$data.type"
        sync:value="$data.value"
        on:enter="$host.handleEnter($data,$index)"
      ></lumi-block>
    </o-fill>
  </div>
  <script>
    export default async () => {
      return {
        tag: "lumi-page",
        data: {
          contents: [
            {
              type: "paragraph",
              value: "aaa",
            },
            {
              type: "paragraph",
              value: "bbb",
            },
            {
              type: "paragraph",
              value: "ccc",
            },
            {
              type: "paragraph",
              value: "",
            },
          ],
        },
        proto: {
          async handleEnter(data, index) {
            const insData = $.stanz({
              type: "paragraph",
              value: "",
            });

            const finnalIndex = index + 1;

            this.contents.splice(finnalIndex, 0, insData);

            setTimeout(() => {
              this.shadow.$("#lumi-fill-el")[finnalIndex].focus();
            }, 10);
          },
        },
      };
    };
  </script>
</template>
