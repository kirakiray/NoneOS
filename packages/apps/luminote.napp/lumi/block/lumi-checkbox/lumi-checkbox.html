<template component>
  <l-m src="/packages/pui/checkbox/checkbox.html"></l-m>
  <style>
    :host {
      display: flex;
      align-items: flex-start;
    }

    p-checkbox {
      display: block;
      margin: 0.2em 0px 0 4px;
    }
  </style>
  <p-checkbox sync:checked="eleChecked"></p-checkbox>
  <div style="position: relative; margin-left: 6px; flex: 1">
    <slot></slot>
  </div>
  <script>
    export default async ({ load }) => {
      return {
        tag: "lumi-checkbox",
        attrs: {
          checked: null,
        },
        data: {
          eleChecked: false,
        },
        watch: {
          checked(checked) {
            if (checked) {
              this.eleChecked = true;
            } else {
              this.eleChecked = false;
            }
          },
          eleChecked(eleChecked) {
            this.checked = eleChecked ? "1" : null;
          },
        },
        proto: {
          setValue() {},
          get textContent() {
            try {
              return this.host.host._currentTextContent;
            } catch (e) {
              return this.text;
            }
          },
          get htmlContent() {
            const html = this.host.host._currentHtmlContent;

            return `<lumi-checkbox ${
              this.checked ? 'checked="1"' : ""
            }>${html}</lumi-checkbox>`;
          },
          get mdContent() {
            return `- [${this.eleChecked ? "x" : " "}] ${this.textContent}`;
          },
        },
      };
    };
  </script>
</template>
