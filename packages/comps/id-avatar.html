<template component>
  <l-m src="/packages/libs/jdenticon/jdent-icon.html"></l-m>
  <style>
    :host {
      display: inline-block;
    }

    jdent-icon {
      display: block;
      width: 100%;
      height: 100%;
    }
  </style>
  <jdent-icon :value="val"></jdent-icon>
  <script>
    export default async ({ load }) => {
      const { createUser } = await load("/packages/user/main.js");

      return {
        tag: "n-id-avatar",
        attrs: {
          val: "",
        },
        watch: {
          val(val) {
            if (val === "self") {
              (async () => {
                const localUser = await createUser();
                this.val = localUser.userId;
              })();
              return;
            }
          },
        },
      };
    };
  </script>
</template>
