<template component>
  <style>
    :host {
      display: flex;
      align-items: center;
      position: fixed;
      left: 0;
      top: 0;
      width: 100%;
      height: 50px;
      z-index: 2;
    }

    .lang-selector {
      margin: 0 16px 0 auto;
      height: 26px;
    }
  </style>
  <select class="lang-selector" sync:value="currentLang" on:change="changeLang">
    <option value="cn">中文</option>
    <option value="en">English</option>
    <option value="ja">日本語</option>
  </select>
  <script>
    export default async ({ load }) => {
      return {
        tag: "main-top",
        data: {
          currentLang: "",
        },
        proto: {
          changeLang(e) {
            const lang = e.target.value;

            localStorage.setItem("webmaker_currentLang", lang);
            location.reload();
          },
        },
        attached() {
          setTimeout(() => {
            // 判断当前系统是否黑夜模式
            const isDarkMode =
              window.matchMedia &&
              window.matchMedia("(prefers-color-scheme: dark)").matches;

            // let isDark = isDarkMode;
            let isDark = false;

            if (isDark) {
              document.documentElement.classList.add("theme-dark-mode");
              document.documentElement.classList.remove("theme-light-mode");
              this.host.shadow.$("bg-one").setDayMode(false);
            } else {
              document.documentElement.classList.remove("theme-dark-mode");
              document.documentElement.classList.add("theme-light-mode");
              this.host.shadow.$("bg-one").setDayMode(true);
            }
          }, 100);
        },
      };
    };
  </script>
</template>
