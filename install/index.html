<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Install NoneOS</title>

    <script>
      fetch("/package-use-online");
      window.__useOnlinePkgTimer = setInterval(() => {
        fetch("/package-use-online");
      }, 2000);
    </script>

    <script src="/packages/libs/ofa/ofa.js#debug"></script>
    <link rel="stylesheet" href="/packages/pui/css/colors.css" />
    <link rel="stylesheet" href="/packages/others/colors.css" pui-colors />
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        height: 100%;
      }

      body {
        font: 400 1em/1.8 -apple-system, BlinkMacSystemFont, Segoe UI,
          Microsoft Yahei, Helvetica, Arial, sans-serif, Apple Color Emoji,
          Segoe UI Emoji;
      }

      .loading {
        display: flex;
        align-items: center;
        justify-content: center;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        color: var(--md-sys-color-on-surface, #1b1b1b);
        background-color: var(--md-sys-color-surface, #f1f1f1);
        background-image: url(/packages/others/default-bg.jpg);
        background-size: cover;
        background-position: center;
        z-index: 20;
        transition: all 0.2s ease;
      }

      @media (prefers-color-scheme: dark) {
        .loading {
          color: var(--md-sys-color-on-surface, #f1f1f1);
          background-color: var(--md-sys-color-surface, #1b1b1b);
        }
      }
    </style>
  </head>
  <body>
    <div class="loading">Loading...</div>
    <n-installer
      appicon="/packages/others/logo.png"
      step="0"
      style="background-image: url(/packages/others/default-bg.jpg)"
    >
      <div install-name>
        <n-desc name="install" space="installer"></n-desc>
      </div>
      <n-installer-page>
        <div step-name>
          <n-desc name="welcome" space="installer"></n-desc>
        </div>
        <o-page src="/install/pages/welcome.html"></o-page>
      </n-installer-page>
      <n-installer-page>
        <div step-name>
          <n-desc name="agreement" space="installer"></n-desc>
        </div>
        <o-page src="/install/pages/agreement.html"></o-page>
      </n-installer-page>
      <n-installer-page>
        <div step-name>
          <n-desc name="startInstall" space="installer"></n-desc>
        </div>
        <template>
          <o-page src="/install/pages/install-os.html"></o-page>
        </template>
      </n-installer-page>
      <n-installer-page>
        <div step-name>
          <n-desc name="installEnd" space="installer"></n-desc>
        </div>
        <template>
          <o-page src="/install/pages/installed.html"></o-page>
        </template>
      </n-installer-page>
    </n-installer>
    <script type="module">
      import { setSpace } from "/packages/i18n/data.js";
      setSpace("installer", "/install/lang");

      const load = lm(import.meta);
      $(".loading").text = `Loading 0/3`;
      await load("/packages/i18n/component.html");
      await load("/packages/pui/public/init.js");
      $(".loading").text = `Loading 1/3`;
      await load("/packages/pui/provider/provider.html");
      $(".loading").text = `Loading 2/3`;
      await load("/packages/comps/installer/installer.html");
      $(".loading").text = `Loading 3/3`;
      await load("/packages/comps/installer/installer-page.html");

      $(".loading").style.opacity = 0;
      setTimeout(() => {
        $(".loading").remove();
      }, 200);
    </script>
  </body>
</html>
