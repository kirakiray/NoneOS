<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Parent Directory Test</title>
  </head>
  <body>
    <script src="/sw/register.js" type="module"></script>
    <script type="module">
      import { init } from "/packages/fs/main.js";
      import { runTest } from "/tests/runTest.js";

      // 初始化测试目录
      const testDirectory = await init("test-dir3");

      // 测试父目录是否相同
      await runTest("Parent Directory Comparison Test", async () => {
        const testFile = await testDirectory.get("a/b/c/d/test.txt", {
          create: "file",
        });
        const fileParentDir = await testFile.parent();

        const directoryD = await testDirectory.get("a/b/c/d");

        const isSame = await fileParentDir.isSame(directoryD);

        return {
          assert: isSame,
          content: `Expected file parent directory to be the same as directory 'd'`,
        };
      });

      // 测试根目录是否相同
      await runTest("Root Comparison Test", async () => {
        const testFile = await testDirectory.get("a/b/c/d/test.txt", {
          create: "file",
        });

        const root1 = await testFile.root();

        const directoryD = await testDirectory.get("a/b/c/d");

        const root2 = await directoryD.root();

        const isSame = await root1.isSame(root2);

        return {
          assert: isSame,
          content: `Expected root directory to be the same as directory 'd'`,
        };
      });

      // 测试删除
      await runTest("Remote Test", async () => {
        const testFile = await testDirectory.get("a2/test2.txt", {
          create: "file",
        });

        await testFile.write("some text");

        const size = await testFile.size();

        await testFile.remove();

        const reTestFile = await testDirectory.get("a2/test2.txt");

        return {
          assert: !reTestFile,
          content: `Expected file to be deleted`,
        };
      });
    </script>
  </body>
</html>
