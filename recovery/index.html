<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NoneOS Recovery</title>
    <script>
      fetch("/package-use-online");
      window.__useOnlinePkgTimer = setInterval(() => {
        fetch("/package-use-online");
      }, 2000);
    </script>
    <script src="/packages/libs/ofa/ofa.js#debug"></script>
    <script src="/packages/pui/public/init.js" type="module"></script>
    <link rel="stylesheet" href="/packages/pui/css/colors.css" />
    <link rel="stylesheet" href="/packages/others/colors.css" pui-colors />
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        height: 100%;
        color: var(--md-sys-color-on-surface);
        background-color: var(--md-sys-color-surface);
      }

      body {
        font: 400 1em/1.8 -apple-system, BlinkMacSystemFont, Segoe UI,
          Microsoft Yahei, Helvetica, Arial, sans-serif, Apple Color Emoji,
          Segoe UI Emoji;
      }
      .main {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        box-sizing: border-box;
        padding: 16px;
        width: 100%;
        height: 100%;
      }
    </style>
  </head>
  <body>
    <l-m src="/packages/pui/button/button.html"></l-m>
    <div class="main">
      <h1>系统恢复模式</h1>
      <p>当您无法正常访问虚拟系统时，可以在此处导出系统数据以防数据丢失。</p>
      <div>
        <p-button id="export-btn">导出本地存储数据</p-button>
      </div>
      <p>
        完成数据导出后，您可以尝试清除所有系统数据并重启浏览器，然后重新访问虚拟系统。
      </p>
      <p-button color="error" variant="outlined">清除系统数据</p-button>
    </div>
    <script type="module">
      const load = lm(import.meta);
      const { exportHandle } = await load("/packages/fs/task/main.js");

      const exportBtn = $("#export-btn");
      exportBtn.on("click", () => {
        exportHandle(
          ["local"],
          "noneos-local-backup-" +
            new Date().toLocaleString().replace(/[\/ :]/g, "-")
        );
      });
    </script>
  </body>
</html>
